<!DOCTYPE html>
<html>
    <!-- title -->




<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" >
    <meta name="author" content="Hayato">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="Hayato">
    <meta name="keywords" content="Hayato's Studio | Hayato">
    <meta name="description" content="">
    <meta name="Cache-Control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>网游加速器原理、技术与实现 · Hayato&#39;s Studio</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s 1;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href= /css/style.css?v=20180709 as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <link rel="stylesheet" href= /css/mobile.css?v=20180709 media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href= "/assets/favicon.ico" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script" />
    <link rel="preload" href="/scripts/main.js" as="script" />
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    
    <!-- fancybox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script>
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
</head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/" >Hayato&#39;s Studio.</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">网游加速器原理、技术与实现</a>
            </div>
    </div>
    
    <a class="home-link" href=/>Hayato's Studio.</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style=








height:50vh;

>
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            网游加速器原理、技术与实现
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class= post-intro-tags >
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "proxy">proxy</a>
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "加速器">加速器</a>
    
</div>
                
                
                    <div class="post-intro-read">
                        <span>Word count: <span class="post-count">7,212</span> / Reading time: <span class="post-count">25 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                    <span class="post-intro-time">2020/11/19</span>
                    
                    <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                        <span class="iconfont-archer">&#xe602;</span>
                        <span id="busuanzi_value_page_pv"></span>
                    </span>
                    
                    <span class="shareWrapper">
                        <span class="iconfont-archer shareIcon">&#xe71d;</span>
                        <span class="shareText">Share</span>
                        <ul class="shareList">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>
        <script>
 
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IE内核
        presto: u.indexOf('Presto') > -1, //opera内核
        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
        iPad: u.indexOf('iPad') > -1, //是否为iPad
        webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
        weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
        uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in');
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //所有字体开始加载
          // console.log('loading');
        },
        active: function () {  //所有字体已渲染
          fontLoaded();
        },
        inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <p>(<a href="http://blog.csdn.net/kidwei/article/details/8559842)" target="_blank" rel="noopener">http://blog.csdn.net/kidwei/article/details/8559842)</a>)</p>
<h2 id="1-前言"><a href="#1-前言" class="headerlink" title="1. 前言"></a>1. 前言</h2><p>网游加速器是针对个人用户快速连接网游服务器的一种服务。为了解决国内南北网络互联瓶颈的问题，“网络加速器”厂商通过搭建多个高带宽的双线机房(或通过租用双线VPS主机），并在这些机房的两大线路中架设多个节点服务器，然后为其编写“网络加速器客户端”，通过客户端判断用户的网络线路类型，并将用户应用客户端的网络数据转发到指定的节点服务器，由节点服务器转发给用户应用客户端请求的真正服务器。“网络加速器客户端”通过自动选择速度最快的节点服务器进行数据转发，以达到数据加速作用。优秀的网络加速器可以有效减少网络丢包和网络延迟。</p>
<p>本文基于前期对各种加速器的分析以及对其中的关键技术进行试验。文章首先对互联网上流行的网游加速器分析结果进行简要汇总，然后针对各种不同的加速器实现方式进行详细实现细节的介绍。</p>
<h2 id="2-流行加速器分析"><a href="#2-流行加速器分析" class="headerlink" title="2. 流行加速器分析"></a>2. 流行加速器分析</h2><p>本文前期对目前流行的网游加速器（或网络加速器）客户端进行了一定的深度分析，了解了这些网络加速器的使用特点、应用领域以及所采用的关键技术。目前网络上流行的网络加速器主要有：迅游加速器、迅雷网游加速器、盛大ET加速器、LavaVPN、NetPas等。</p>
<p>迅游加速器（<a href="http://www.xunyou.com）和迅雷网络加速器迅游版（http://jaisuqi.xunlei.com）是专门针对网游的加速器。迅雷共有两款加速器，自研的“给力加速器”提供免费加速服务，“迅游版加速器”是与迅游合作的产品。它们在软件UI设计和功能大致相同，使用流程也如出一辙：启动加速功能前需要选择指定的游戏及其区服，注意：待加速游戏必须是其客户端列表中指定的游戏，对于未指定的游戏不能被加速。" target="_blank" rel="noopener">http://www.xunyou.com）和迅雷网络加速器迅游版（http://jaisuqi.xunlei.com）是专门针对网游的加速器。迅雷共有两款加速器，自研的“给力加速器”提供免费加速服务，“迅游版加速器”是与迅游合作的产品。它们在软件UI设计和功能大致相同，使用流程也如出一辙：启动加速功能前需要选择指定的游戏及其区服，注意：待加速游戏必须是其客户端列表中指定的游戏，对于未指定的游戏不能被加速。</a></p>
<p>启动加速后加速客户端对其全部节点服务器进行测速（迅游加速器部署了82个节点服务器），然后选择速度最快的服务器作为转发服务器，并在本地建立IP地址以172开头的虚拟网卡（局域网地址）。启动后通过抓包工具分析，所有发送到该游戏服务器的数据都是从该172开头的虚拟网卡地址发出的（VPN技术？），而不是从物理网卡地址发出。通过查看路由表，被加速的游戏当前所使用的服务器被增加到了路由表中，并指向了该172开头的虚拟网卡地址。</p>
<p>在对迅游加速器分析过程中还发现，迅游加速器在加速过程中使用了LSP技术（一种通过在TCP/IP协议上层安装一层用户自定义协议，可以对WinSock2  API进行拦截的技术），并对WSAConnnect函数进行了拦截。</p>
<p>迅雷给力加速器也提供了四种加速模式，模式一采用的是基于LSP的代理加速方式，通过LSP技术，将用户的网络数据直接转发给代理服务器，再由代理服务器将数据转发给真正的游戏服务器；模式二采用的是基于L2TP协议的VPN技术；模式三采用的是基于PPTP协议的VPN技术；模式四采用的是基于基于OpenVPN的VPN技术。这三种模式在启动加速后都需要修改路由表，以实现针对指定目的IP的加速功能。</p>
<p>VPN顾名思义，虚拟专网，你接入VPN就是接入了一个专有网络，那么你访问网络都是从这个专有网络的出口出去，好比你在家，你家路由器后面的网络设备是在同一个网络，而VPN则是让你的设备进入了另一个网络。同时你的IP地址也变成了由VPN分配的一个IP地址。通常是一个私网地址。你和VPN服务器之间的通信是否加密取决于连接VPN的具体方式/协议。<br>代理服务器则是把你的网络数据请求通过一条连接你和代理服务器之间的通道，由服务器转发到目的地。你没有加入任何新的网络，只是http/socks数据经过代理服务器的转发送出，并从代理服务器接收回应。你与代理服务器通信过程不会被额外处理，如果你用https，那本身就是加密的。</p>
<p>LavaVPN（<a href="http://www.lavajsq.com，已经改名为LavaJSQ）是一款可以针对所有网络应用进行加速的网络加速器。它采用了VPN技术对网络进行加速，并提供四种VPN协议模型进行加速：PPTP、L2TP、OpenVPN（SSL_TCP）、OpenVPN（SSL_UDP），并可以通过增删路由表的形式，针对不同的应用进行加速：仅加速国外访问、仅加速对网通（电信）的网络访问、仅加速某些进程的网络访问等等。" target="_blank" rel="noopener">http://www.lavajsq.com，已经改名为LavaJSQ）是一款可以针对所有网络应用进行加速的网络加速器。它采用了VPN技术对网络进行加速，并提供四种VPN协议模型进行加速：PPTP、L2TP、OpenVPN（SSL_TCP）、OpenVPN（SSL_UDP），并可以通过增删路由表的形式，针对不同的应用进行加速：仅加速国外访问、仅加速对网通（电信）的网络访问、仅加速某些进程的网络访问等等。</a></p>
<p>对LavaVPN的分析过程中未发现其有使用到LSP技术的迹象。</p>
<p>盛大ET加速器（<a href="http://etspeed.sdo.com）是一款可以针对网络游戏加速以及语音加速的工具。ET加速器在结构设计上与迅游加速器有明显区别，但是功能类似：仅支持对其游戏列表中的游戏加速、启动加速功能后在本机建立了虚拟网卡，并添加了指向虚拟网卡地址的路由、在本机安装了LSP协议。ET加速器启动加速后，在“我的连接”面板里新增出现了一个名为“etaaaaaa”的网络连接。" target="_blank" rel="noopener">http://etspeed.sdo.com）是一款可以针对网络游戏加速以及语音加速的工具。ET加速器在结构设计上与迅游加速器有明显区别，但是功能类似：仅支持对其游戏列表中的游戏加速、启动加速功能后在本机建立了虚拟网卡，并添加了指向虚拟网卡地址的路由、在本机安装了LSP协议。ET加速器启动加速后，在“我的连接”面板里新增出现了一个名为“etaaaaaa”的网络连接。</a></p>
<h2 id="3-加速器实现方式概要"><a href="#3-加速器实现方式概要" class="headerlink" title="3. 加速器实现方式概要"></a>3. 加速器实现方式概要</h2><p>通过对以上加速器的分析进行参考，并查阅相关资料，目前主流的加速技术可以采用两种方式来实现：“代理服务器方式”和“VPN方式”。</p>
<p>代理服务器方式通过部署SOCKS5代理服务器作为加速节点，加速客户端自动选择最快的代理服务器作为当前的转发节点。在客户端主要采用LSP技术，在用户的主机安装分层协议，在游戏客户端调用connect函数（或WSAConnect函数）试图连接游戏服务器时，将连接重定向到代理服务器，并采用SOCKS5协议规范与代理服务器进行数据协商，由代理服务器来连接真正的游戏服务器，并将游戏服务器的数据原封不动转发给用户、将用户的数据原封不动转发给游戏服务器。</p>
<p>VPN方式需要部署双线VPN服务器作为加速节点，加速客户端自动选择速度最快的VPN服务器，并通过VPN拨号连接到VPN服务器并获取一个虚拟IP地址，同时通过修改路由表的方式，将指定进程的网络访问路由到虚拟IP上，而其余地址仍经过原默认路由途径访问。</p>
<p>下面就这两种加速方式的具体实现以及重要的技术难点进行详细分析。另外，报告中的所有代码截图均来自之前写的测试程序，并测试通过；VPN加速方式由主要进行了原理的详细介绍，并编写了支持PPTP协议的VPN客户端和服务器进行了测试。</p>
<h2 id="4-VPN加速方式"><a href="#4-VPN加速方式" class="headerlink" title="4. VPN加速方式"></a>4. VPN加速方式</h2><h3 id="4-1-VPN加速概述"><a href="#4-1-VPN加速概述" class="headerlink" title="4.1. VPN加速概述"></a>4.1. VPN加速概述</h3><p>VPN技术常常被广泛应用于“网游加速技术”和“翻墙技术”中。如前面提到的迅游加速器、迅雷网游加速器、LavaVPN都采用到了VPN技术进行加速，而且目前主流的网游加速器都主要是采用的VPN技术。由于VPN环境的测试需要建立VPN服务器，本人的测试环境有限，所以只是进行了客户端的代码编写并连接通过，无法做相关的代理效果的测试。下面只针对实现的流程和原理给以介绍。</p>
<h3 id="4-2-VPN加速实现步骤"><a href="#4-2-VPN加速实现步骤" class="headerlink" title="4.2. VPN加速实现步骤"></a>4.2. VPN加速实现步骤</h3><p>通过建立如下步骤，可以采用VPN技术来实现网络加速：</p>
<ul>
<li><ol>
<li>部署双线VPN服务器节点；</li>
</ol>
</li>
<li><ol start="2">
<li>加速器客户端启动后选择网络性能最好的VPN服务器，并在客户端进行RAS拨号，与该VPN服务器建立隧道连接，连接建立后将会自动在本机生成一个虚拟网络地址，同时客户端的默认路由会被修改成指向该虚拟网络地址，如果此时不进行特殊处理，客户端的所有网络访问将都会通过该VPN通道出去；</li>
</ol>
<ul>
<li><ol start="3">
<li>因为网游加速器的功能需求是仅仅针对某款游戏进行加速，即：在知道这款游戏连接的服务器IP的前提下，只有发送到该服务器IP的数据才被加速，其他网络数据应该不受影响。因此加速客户端在建立完VPN通道以后，需要立即修改路由表：在拨号前通过修改拨号参数，使其不修改本机的默认路由表；其次，将游戏服务器IP增加到路由表中，并让其指向VPN拨号建立的虚拟网络地址上。这样，与游戏服务器之间的通信都走VPN通道，而其他网络数据都不受影响。</li>
</ol>
</li>
</ul>
</li>
</ul>
<h3 id="4-3-VPN加速使用的三种协议介绍"><a href="#4-3-VPN加速使用的三种协议介绍" class="headerlink" title="4.3 VPN加速使用的三种协议介绍"></a>4.3 VPN加速使用的三种协议介绍</h3><p>目前网络上现有的网游加速器（或网络加速器）都使用到了三种VPN协议：PPTP、L2TP和OpenVPN。各种不同的协议在使用时可能受用户的网络状况的限制而无法使用，因此一般的网络加速器都会提供不同的加速模式供用户选择。或在启动加速过程中根据用户当前的网络状况自动选择可用的加速模式。</p>
<p>PPTP协议：PPTP协议是在PPP协议基础上开发的增强型安全协议。PPTP协议中有两个流：控制流和数据流。PPTP协议的数据流采用了GRE协议，由于该协议的特殊性，如果同一个NAT中有两个或以上的主机同时在发送PPTP协议数据包，当数据包从外部达到NAT时，NAT将无法通过端口将数据转发到不同的主机，因此，当使用PPTP协议时，如果用户所在的NAT网关不支持VPN穿透功能（即支持PPTP协议的NAT编辑器，该编辑器在GRE协议的报头使用了一个CallId用来表示NAT下的一个会话，通过CallId来模拟端口，做NAT映射），那么内部主机只能与同一个服务器中间建立一个会话，不能有第二个客户端。目前，大多数NAT网关都具有PPTP NAT编辑器，能很好的支持PPTP协议。</p>
<p>L2TP协议：第二层隧道协议，该协议是PPTP协议和Cisco第二层转发协议L2F的结合体。在windows建立的基于L2TP协议的VPN连接中，默认是启用了证书方式的IPSec协议作为安全传输协议，IPSec协议为了保护IP数据包的完整性，会禁止任何对数据包的修改，否则修改后的数据包达到目的主机后其解密和完整性认证就会失败，从而导致这个报文被认为是非法数据而被丢弃。而当加速器客户端位于NAT后时，数据包在通过NAT时，NAT会对IP头数据等进行修改，导致数据到达VPN服务器时被认为是非法数据而丢弃。</p>
<p>解决该问题的一种方式是通过硬件方式：要求通信的双方的边界路由都支持NAT-T，基本原理是在IPSec封装好的数据包外再进行一次UDP的数据封装，因此，当数据包穿过NAT网关时，被修改的只是外层IP/UDP头，而真正的IPSec数据未被修改；到目的主机时再将IP/UDP封装去除，这样就可以得到未被修改的IPSec数据包。</p>
<p>另一种方式是在L2TP协议中禁用IPSec。对于我们制作网络加速器应用来讲，IPSec协议并非必须的，因此，我们可以在加速器连接中去除IPSec协议，而不影响加速功能。在Windows系统下采用RAS进行VPN连接时，若要去除IPSec协议，需要修改注册表并重启机器使之生效。迅游的给力加速器中就是采用这种方式。</p>
<p>OpenVPN模式：OpenVPN是一个基于OpenSSL加密和验证的应用层VPN实现，能够在NAT环境下很好的工作，是今年来新出现的一个基于开源软件体系的VPN项目。使用OpenVPN进行连接前，需要在客户端机器上安装一个虚拟网卡设备，并需要客户端修改路由表。</p>
<p>以上VPN协议中，除了OpenVPN的使用可以不受用户当前网络的限制外，其他两种方式都可能收到用户的NAT情况影响而导致加速失败，因此在实际应用中，各种加速器都会把这几种模式都提供给用户，并根据用户的网络情况进行选择。</p>
<h3 id="4-4-VPN拨号客户端的实现"><a href="#4-4-VPN拨号客户端的实现" class="headerlink" title="4.4 VPN拨号客户端的实现"></a>4.4 VPN拨号客户端的实现</h3><p>试验过程中对RAS拨号建立VPN连接功能进行了测试。如下客户端实现了连接到VPN服务器，并同时客户端用户输入的“待加速地址”列表，修改路由表，已达到“仅指定IP走VPN通道”的功能，而用户的其他网络访问完全不受影响。</p>
<h3 id="4-5-VPN方式尚存在的问题"><a href="#4-5-VPN方式尚存在的问题" class="headerlink" title="4.5 VPN方式尚存在的问题"></a>4.5 VPN方式尚存在的问题</h3><ul>
<li><ol>
<li>与采用代理方式一样，判断与当前启动的游戏通讯的是哪个服务器是个问题（原因如前所述），这里可以用到前面描述的LSP技术，通过在connect函数中判断欲建立连接的IP是否在当前游戏的服务器列表中。此时用到LSP技术并不是用于转发，仅仅用于判断是否加速。</li>
</ol>
</li>
<li><ol start="2">
<li>采用VPN方式有一个问题：如果用户修改路由表，让其他进程的服务器IP（如p2p下载软件）或默认路由表经过VPN通道的话，可能会造成VPN通道中的数据量增大，可能会影响正常的游戏。迅游加速器也没有对该问题进行很好的解决，早前的测试发现迅游加速功能启动后，通过修改路由表，可以使任意客户端进程都使用迅游的加速通道来访问网络。</li>
</ol>
</li>
</ul>
<p>该问题的也许可以通过两种方式来解决：一种是在客户端限制用户修改路由表，另一种是通过在服务器端进行限制非游戏服务器相关的数据。具体实现方式有待研究。</p>
<h2 id="5-代理加速方式"><a href="#5-代理加速方式" class="headerlink" title="5. 代理加速方式"></a>5. 代理加速方式</h2><h3 id="5-1-代理加速的基本原理"><a href="#5-1-代理加速的基本原理" class="headerlink" title="5.1. 代理加速的基本原理"></a>5.1. 代理加速的基本原理</h3><p>采用代理服务器进行网络加速是一类使用较早的技术。目前某些网游客户端和网络应用程序都直接支持SOCKS5代理协议来连接其客户端，客户端提供设置代理服务器IP和端口的方式供玩家来设置。然而大部分网游客户端并不直接支持SOCKS5代理技术。此处介绍的代理加速模式不仅支持那些无法设置SOCKS5代理的网络游戏，即使那些可以设置SOCKS5代理的游戏，玩家也可以不用手动去设置，而自动采用下面介绍的代理加速技术进行代理加速。</p>
<p>代理加速方式可以直接采用SOCKS5协议，由于SOCKS5协议有现成的服务器程序可用，可以节省服务器编写时间；但是也可以自己定义一个“类SOCKS5”的代理协议，自行实现代理协商和身份验证功能。下面的介绍将会基于自己定义代理协议的模式。</p>
<p>在使用代理方式加速时，LSP技术的使用是关键。Microsoft在Winsock2中提供了Winsock服务器提供者（SPI），允许用户在基础TCP/IP协议上层插入自己定义的分层协议（LSP），当用户通过Winsock2 API连接网络或发送网络数据时，如调用WSAConnect函数，将会首先执行到LSP协议的dll中我们定义的函数，这样我们可以先进行处理，然后再交给真正的WSAConnect函数，这样就会起到API Hook的作用。</p>
<p>要使用LSP技术，必须要将写好的LSP协议安装到用户的机器上，安装过程实际就是将DLL放入系统目录，并在注册表中写入该DLL位置信息的过程。注意：安装未签名的LSP时，安装过程中一般防火墙都会有警告提示。</p>
<h3 id="5-2-代理加速方式的实现概要"><a href="#5-2-代理加速方式的实现概要" class="headerlink" title="5.2. 代理加速方式的实现概要"></a>5.2. 代理加速方式的实现概要</h3><p>采用LSP方式进行网络加速需要部署SOCKS5代理服务器作为加速节点，加速客户端自动选择最快的代理服务器作为当前的转发节点。</p>
<p>开发人员在客户端需要完成的动作有：</p>
<ul>
<li><ol>
<li>编写我们自己的LSP协议动态库，重新实现我们需要的相关socket函数，如connect；</li>
</ol>
</li>
<li><ol start="2">
<li>在用户的主机安装我们自己的LSP协议，这一操作可以放入我们的应用程序部署的时候完成，也可以在我们的加速器每次启动的时候进行部署；</li>
</ol>
</li>
<li><ol start="3">
<li>当游戏客户端调用connect函数（或WSAConnect函数）试图连接游戏服务器时，通过LSP将连接重定向到代理服务器，并采用SOCKS5协议规范与代理服务器进行数据协商，由代理服务器来连接真正的游戏服务器，并将游戏服务器的数据原封不动转发给用户、同时将用户的数据原封不动转发给游戏服务器。</li>
</ol>
</li>
</ul>
<p>由于Socks5协议并不涉及协议加密，而且Socks5协议本身协商过程较长，实际在开发中，网络加速器开发商一般都不会直接采用socks协议，而是对该协议进行改造，定义自己的代理协议。</p>
<h3 id="5-3-Socks5协议与LSP结合"><a href="#5-3-Socks5协议与LSP结合" class="headerlink" title="5.3. Socks5协议与LSP结合"></a>5.3. Socks5协议与LSP结合</h3><p>通过LSP技术Hook到相应的套接字函数进行数据转发之前，需要进行Socks5代理协商，即将鉴权信息告诉代理服务器，以及告诉代理服务器自己想连接的真正游戏服务器地址。代理协商完成后才能进行数据的收发。</p>
<p>针对不同的网络连接方式，代理协商的方式有所不同：</p>
<ul>
<li><ol>
<li>普通阻塞方式的TCP连接最简单，可以在hook到connect函数后直接在内部进行阻塞式的代理协商，直到协商完毕后才将connect函数返回给用户，这时候用户拿到的socket实际上是连接到代理服务器的socket，当应用程序通过这个socket收发数据时，实际上是在和代理服务器交互，而这一过程对应用程序来说是透明的，应用程序以为自己是直接在和游戏服务器通信。</li>
</ol>
</li>
</ul>
<p>目前的网络应用程序很少会采用阻塞方式进行TCP连接，所以这种情况应用场景比较少。</p>
<ul>
<li><ol start="2">
<li>非阻塞方式的TCP连接情况比较复杂，有的TCP连接的socket是可以修改阻塞选项，这样，我们可以在connect函数的入口处判断一下当前socket是否是非阻塞，如果是则将其改为阻塞方式，修改后以阻塞方式进行socks5代理协商，协商完毕后再将socket的阻塞方式修改为非阻塞。</li>
</ol>
</li>
<li><ol start="3">
<li>另一种更为复杂的非阻塞TCP连接是基于Windows异步消息的连接，这种连接采用了WSAAsynSelect方式设置了网络消息到来时的Windows接收窗口，所有的网络数据都需要在这个窗口的消息处理函数中处理（QQ飞车的TCP连接就是采用的这种方式）。这类网络模型不能简单采用修改socket阻塞方式的方法来解决。</li>
</ol>
</li>
</ul>
<p>解决这一问题的唯一办法是在LSP中hook住WSAAsynSelect，在该函数中创建一个我们自己的隐藏窗口，让网络应用程序的所有数据都转发我们自己的窗口上来，在我们的窗口的消息处理函数中进行代理协商和网络数据转发。</p>
<ul>
<li><ol start="4">
<li>对于UDP网络数据的socks5代理转发比TCP又要稍微复杂一些，TCP只需要hook到connect和WSAAsynSelect，对于网络收发数据的send和recv函数是不需要我们自己来实现的。UDP由于是不保持连接的，因此每次发送和接收的UDP包都要包含代理协商信息，因此我们需要把RecvFrom函数和SendTo函数都hook住。</li>
</ol>
</li>
</ul>
<p>对于UDP连接，需要在应用程序发送第一个UDP包的时候进行代理协商，以后发送数据的时候按照socks5协议的规定，加上socks5头部；收到的信息去除socks5头部再交给应用程序。</p>
<h3 id="5-4-代理加速方式详细实现"><a href="#5-4-代理加速方式详细实现" class="headerlink" title="5.4. 代理加速方式详细实现"></a>5.4. 代理加速方式详细实现</h3><p>下面就详细介绍每一步的具体实现方式，为了方便流程分析，这里从LSP实现数据包转发开始介绍，最后介绍代理服务器的实现。</p>
<ul>
<li><ol>
<li>利用LSP编写DLL，实现客户端数据包转发功能：</li>
</ol>
</li>
</ul>
<p>编写LSP协议并安装到现有协议之上，需要建立基于DLL的工程，并导出WSPStartup函数，这样当有应用程序创建套接字时，会自动执行到该WSPStartup函数。在WSPStartup函数函数中，参数信息指明了应用程序期望采用哪种协议来创建套接字（所有的协议存在于一个协议链中，该协议链也包含了我们安装的LSP协议），我们需要在该函数中加载下层协议，并调用下层协议提供者的WSPStartup函数初始化，并修改传递给上层的函数表，将我们需要Hook的Winsock2函数指针的地址指向我们自己的函数。关键代码如下：</p>
<p>如果测试程序只针对TCP数据包的转发，只需要实现WSPConnect函数就可以了，其余函数只需要直接调用g_NextProcTable中的默认函数就可以了。</p>
<p>当用户应用程序调用connect函数或WSAConnect函数试图进行TCP连接时，将会先进入LSP的DLL中定义的WSPConnect函数，该函数进入后我们会判断应用程序试图连接的服务器IP和端口是不是我们待加速的服务器，如果是，会执行到socksProxy函数与代理服务器连接，并进行代理协商；如果不是待加速服务器，则执行g_NextProcTable中原有的连接函数，此时LSP就没有起作用，流程与不安装LSP前的流程是一致的。</p>
<ul>
<li><ol start="2">
<li>安装LSP。</li>
</ol>
</li>
</ul>
<p>要使我们上一步实现的转发协议生效，还必须将上一步生成的DLL安装到用户的系统上。只有安装了LSP，应用程序在调用ws2_32.dll中的函数时就会执行到我们的LSP的DLL中。一般来讲，生成的DLL需要放入Windows/System32目录下，一个原因是DLL路径不能有中文等特殊字符，另一方面，如果有其他程序误删了该DLL，会导致整个系统无法上网的现象，还可能导致整个系统崩溃。</p>
<p>安装LSP首先需要安装协议链，需要将下层协议的信息拷贝过来，修改成我们需要的协议特点，并进行安装；然后对协议链进行排序，将我们的协议放在协议链的最上层，以保证ws2_32.dll调用到的第一个协议是我们的协议。</p>
<p>这里需要注意的是，当安装了“迅游加速器”后，系统上原有安装的分层协议将会被移到最下层，导致原有的协议无效。因此，我们在开发自己的网游加速器时需要考虑该问题，并予以避免。</p>
<h3 id="5-4-代理方式尚存在的问题"><a href="#5-4-代理方式尚存在的问题" class="headerlink" title="5.4. 代理方式尚存在的问题"></a>5.4. 代理方式尚存在的问题</h3><ul>
<li><ol>
<li>不同网络加速器厂商的LSP安装程序相互之间可能会出现不兼容的情况，所以我们实现自己的加速LSP的时候，其他网络加速器厂商可能对我们安装的协议干扰，如迅游在安装和每次启动的时候会删除其他厂商的LSP协议；</li>
</ol>
</li>
<li><ol start="2">
<li>如前所述，LSP在Hook到connect函数后，在WSPConnect函数中会判断当前连接的服务器是否是需要被加速的目的地址。如何获得用户当前启动的游戏的IP和端口是多少是一个难点，因为一个游戏可能连接了多个服务器并开启了多个端口，而真正进行通讯的只是其中一个；另一方面，通过加速客户端启动的进行可能并不是真正的游戏进程（可能只是一个升级程序）。</li>
</ol>
</li>
</ul>
<p>迅游加速器可能收集了每款待加速游戏的服务器ip和端口，如果客户端发送网络包的目的地址是这些ip的时候，才会针对这些目的ip地址进行加速。本人有过测试：首先获取迅游加速器支持的某款游戏的某个服务器IP和端口，然后自己编写一个客户端不断给该服务器的端口发送数据，当该exe替换游戏的exe并启动后，从抓包结果来看，加速功能仍然有效；当从迅游列表中选择另一款游戏，启动exe时仍启动我们刚刚编写的exe时，加速功能就失效了。因此可以推测：迅游加速器并不是通过判断进程信息来获取目的服务器的（况且通过判断进程信息来获取目的服务器IP并不容易实现，如前所述），而是通过用户从列表中选择的游戏的名称。</p>
<h2 id="6-总结"><a href="#6-总结" class="headerlink" title="6. 总结"></a>6. 总结</h2><p>本文主要介绍了两种实现网游加速的可行的技术方案，其中提到的对其他网络游戏加速器的分析以及具体实现细节可能会有一些不完善之处。</p>
<p>加速器实际实现过程中，还有关键一步就是判断当前用户的网络环境。比如用户当前连接的服务器是网通服务器，更智能的做法是在加速之前提前判断当前用户的网络情况，如果用户是网通用户，则不必启用加速功能，如果用户是电信或其他网络，则需要给用户提示可以启动加速功能，并由用户来决定是否启用加速。</p>
<p>当前游戏如果采用了P2P通信，用户网络环境的判断仍然需要被考虑。如QQ飞车和CF等对战游戏，启动游戏后建立了P2P连接，是否需要对这些P2P连接进行加速呢？这种情况也需要考虑用户的当前网络环境：如果P2P双方处于同一个NAT下，则不需要加速，如果一方是电信用户，而另一方是网通用户，就需要加速功能。</p>
<p>用户网络环境的判断（包括是否处于同一个NAT下的判断）是进行网络加速器的具体实现前需要解决的技术问题。</p>

    </article>
    <!-- license  -->
    
        <div class="license-wrapper">
            <p>原文作者: <a href="https://haojiaqiang.github.io">Hayato</a>
            <p>原文链接: <a href="https://haojiaqiang.github.io/2020/11/19/网游加速器原理/">https://haojiaqiang.github.io/2020/11/19/网游加速器原理/</a>
            <p>发表日期: <a href="https://haojiaqiang.github.io/2020/11/19/网游加速器原理/">November 19th 2020, 4:26:47 pm</a>
            <p>版权声明: <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC-SA 4.0</a></p>
        </div>
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href= "/2017/11/30/关于死锁的几个经典问题/" title= 关于死锁的几个经典问题 >
                    <div class="prevTitle">关于死锁的几个经典问题</div>
                </a>
            
        </li>
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

<!-- City版安装代码已完成 -->
    
    
    <!--PC和WAP自适应版-->

    <!--PC版-->


    
    

    <!-- 评论 -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
    
        
            
                <a href="https://github.com/haojiaqiang" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            
                <a href="https://about.me/haojiaqiang" class="iconfont-archer others" target="_blank" title=others></a>
            
        
    
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- 不蒜子  -->
    
    <div class="busuanzi-container">
    
     
    <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
    
    </div>
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:50vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-前言"><span class="toc-number">1.</span> <span class="toc-text">1. 前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-流行加速器分析"><span class="toc-number">2.</span> <span class="toc-text">2. 流行加速器分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-加速器实现方式概要"><span class="toc-number">3.</span> <span class="toc-text">3. 加速器实现方式概要</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-VPN加速方式"><span class="toc-number">4.</span> <span class="toc-text">4. VPN加速方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-VPN加速概述"><span class="toc-number">4.1.</span> <span class="toc-text">4.1. VPN加速概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-VPN加速实现步骤"><span class="toc-number">4.2.</span> <span class="toc-text">4.2. VPN加速实现步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-VPN加速使用的三种协议介绍"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 VPN加速使用的三种协议介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-VPN拨号客户端的实现"><span class="toc-number">4.4.</span> <span class="toc-text">4.4 VPN拨号客户端的实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-VPN方式尚存在的问题"><span class="toc-number">4.5.</span> <span class="toc-text">4.5 VPN方式尚存在的问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-代理加速方式"><span class="toc-number">5.</span> <span class="toc-text">5. 代理加速方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-代理加速的基本原理"><span class="toc-number">5.1.</span> <span class="toc-text">5.1. 代理加速的基本原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-代理加速方式的实现概要"><span class="toc-number">5.2.</span> <span class="toc-text">5.2. 代理加速方式的实现概要</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-Socks5协议与LSP结合"><span class="toc-number">5.3.</span> <span class="toc-text">5.3. Socks5协议与LSP结合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-代理加速方式详细实现"><span class="toc-number">5.4.</span> <span class="toc-text">5.4. 代理加速方式详细实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-代理方式尚存在的问题"><span class="toc-number">5.5.</span> <span class="toc-text">5.4. 代理方式尚存在的问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-总结"><span class="toc-number">6.</span> <span class="toc-text">6. 总结</span></a></li></ol>
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- 在ejs中将archive按照时间排序 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 20
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2020 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/19</span><a class="archive-post-title" href= "/2020/11/19/网游加速器原理/" >网游加速器原理、技术与实现</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2017 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/30</span><a class="archive-post-title" href= "/2017/11/30/关于死锁的几个经典问题/" >关于死锁的几个经典问题</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/03</span><a class="archive-post-title" href= "/2017/09/03/howRuntimeWorks/" >彻底理解Runtime</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/29</span><a class="archive-post-title" href= "/2017/06/29/Runloop/" >Runloop</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/08</span><a class="archive-post-title" href= "/2017/05/08/Computer-Networking-A-Top-Down-Approach-NOTES/" >计算机网络 自顶向下方法</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/19</span><a class="archive-post-title" href= "/2017/04/19/GCD-queue-and-sync-async/" >GCD队列与同步异步的组合</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/02</span><a class="archive-post-title" href= "/2017/01/02/iOS-Core-Animation/" >iOS Core Animation</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2016 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/20</span><a class="archive-post-title" href= "/2016/11/20/Design-Pattern-Odyssey/" >大话设计模式</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/30</span><a class="archive-post-title" href= "/2016/09/30/Algorithms/" >Algorithms</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/30</span><a class="archive-post-title" href= "/2016/09/30/操作系统原理/" >操作系统原理</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/08</span><a class="archive-post-title" href= "/2016/09/08/Effective-Objective-C-2-0/" >Effective Objective-C 2.0 编写高质量iOS与OS X代码的52个有效方法</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/03</span><a class="archive-post-title" href= "/2016/08/03/SwiftGrammar/" >SwiftGrammar</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/22</span><a class="archive-post-title" href= "/2016/05/22/Computer-Systems-A-Programmer-s-Perspective/" >深入理解计算机系统</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/22</span><a class="archive-post-title" href= "/2016/04/22/Pro-multithreading-and-memory-management-for-iOS-and-OS-X/" >Object-C 高级编程 iOS和OS X多线程和内存管理</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/12</span><a class="archive-post-title" href= "/2016/03/12/git/" >Git</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2015 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/25</span><a class="archive-post-title" href= "/2015/06/25/special-kind-of-pointer/" >几种特殊指针的含义区别</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/08</span><a class="archive-post-title" href= "/2015/05/08/InstallShadowsocks/" >部署Shadowsocks</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/30</span><a class="archive-post-title" href= "/2015/03/30/SQL查询实现方式/" >SQL查询实现方式</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/11</span><a class="archive-post-title" href= "/2015/03/11/SQL/" >SQL</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/01</span><a class="archive-post-title" href= "/2015/01/01/How-does-the-program-run/" >程序是怎样跑起来的</a>
        </li>
    
    </div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="设计模式"><span class="iconfont-archer">&#xe606;</span>设计模式</span>
    
        <span class="sidebar-tag-name" data-tags="async"><span class="iconfont-archer">&#xe606;</span>async</span>
    
        <span class="sidebar-tag-name" data-tags="sync"><span class="iconfont-archer">&#xe606;</span>sync</span>
    
        <span class="sidebar-tag-name" data-tags="queue"><span class="iconfont-archer">&#xe606;</span>queue</span>
    
        <span class="sidebar-tag-name" data-tags="app"><span class="iconfont-archer">&#xe606;</span>app</span>
    
        <span class="sidebar-tag-name" data-tags="多线程"><span class="iconfont-archer">&#xe606;</span>多线程</span>
    
        <span class="sidebar-tag-name" data-tags="内存管理"><span class="iconfont-archer">&#xe606;</span>内存管理</span>
    
        <span class="sidebar-tag-name" data-tags="SQL"><span class="iconfont-archer">&#xe606;</span>SQL</span>
    
        <span class="sidebar-tag-name" data-tags="pointer"><span class="iconfont-archer">&#xe606;</span>pointer</span>
    
        <span class="sidebar-tag-name" data-tags="id"><span class="iconfont-archer">&#xe606;</span>id</span>
    
        <span class="sidebar-tag-name" data-tags="NSObject"><span class="iconfont-archer">&#xe606;</span>NSObject</span>
    
        <span class="sidebar-tag-name" data-tags="id<NSObject>"><span class="iconfont-archer">&#xe606;</span>id<NSObject></span>
    
        <span class="sidebar-tag-name" data-tags="void *"><span class="iconfont-archer">&#xe606;</span>void *</span>
    
        <span class="sidebar-tag-name" data-tags="nil"><span class="iconfont-archer">&#xe606;</span>nil</span>
    
        <span class="sidebar-tag-name" data-tags="Nil"><span class="iconfont-archer">&#xe606;</span>Nil</span>
    
        <span class="sidebar-tag-name" data-tags="NSNull"><span class="iconfont-archer">&#xe606;</span>NSNull</span>
    
        <span class="sidebar-tag-name" data-tags="deadLock"><span class="iconfont-archer">&#xe606;</span>deadLock</span>
    
        <span class="sidebar-tag-name" data-tags="计算机系统"><span class="iconfont-archer">&#xe606;</span>计算机系统</span>
    
        <span class="sidebar-tag-name" data-tags="消息"><span class="iconfont-archer">&#xe606;</span>消息</span>
    
        <span class="sidebar-tag-name" data-tags="load"><span class="iconfont-archer">&#xe606;</span>load</span>
    
        <span class="sidebar-tag-name" data-tags="Shadowsocks"><span class="iconfont-archer">&#xe606;</span>Shadowsocks</span>
    
        <span class="sidebar-tag-name" data-tags="CentOS"><span class="iconfont-archer">&#xe606;</span>CentOS</span>
    
        <span class="sidebar-tag-name" data-tags="AWS root"><span class="iconfont-archer">&#xe606;</span>AWS root</span>
    
        <span class="sidebar-tag-name" data-tags="Swift"><span class="iconfont-archer">&#xe606;</span>Swift</span>
    
        <span class="sidebar-tag-name" data-tags="Git"><span class="iconfont-archer">&#xe606;</span>Git</span>
    
        <span class="sidebar-tag-name" data-tags="proxy"><span class="iconfont-archer">&#xe606;</span>proxy</span>
    
        <span class="sidebar-tag-name" data-tags="加速器"><span class="iconfont-archer">&#xe606;</span>加速器</span>
    
        <span class="sidebar-tag-name" data-tags="OS"><span class="iconfont-archer">&#xe606;</span>OS</span>
    
        <span class="sidebar-tag-name" data-tags="runtime"><span class="iconfont-archer">&#xe606;</span>runtime</span>
    
        <span class="sidebar-tag-name" data-tags="计算机网络"><span class="iconfont-archer">&#xe606;</span>计算机网络</span>
    
        <span class="sidebar-tag-name" data-tags="Runloop"><span class="iconfont-archer">&#xe606;</span>Runloop</span>
    
        <span class="sidebar-tag-name" data-tags="Core Animation"><span class="iconfont-archer">&#xe606;</span>Core Animation</span>
    
        <span class="sidebar-tag-name" data-tags="Algorithms"><span class="iconfont-archer">&#xe606;</span>Algorithms</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br/>
    1、请确保node版本大于6.2<br/>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br/>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br/>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: "/",
        author: "Hayato"
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- algolia -->
    
    <!-- busuanzi  -->
    
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    </div>
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
     
    </body>
</html>


